# ניהול הרשאות של קבצים ותיקיות
במאמר זה נסקור את יסודות ההרשאות שיש למשתמשים במערכת לגשת לקבצים, לקרוא בהם, לכתוב אליהם, ולהריץ אותם. נזכיר גם את נושא חלוקת המשתמשים לקבוצות, אם כי לא נתמקד בזה.

## מה הם הרשאות?
הרשאות הם הגדרת היכולת שיש ביד כל משתמש במערכת. יש מתשמש שהוא המנהל, ויש משתמש סגן מנהל, ויש משתמש רגיל, ויש משתמש אורח. לכל אחד מהמשתמשים שהזכרתי יכול לעשות דברים בהתאם לתפקידו. 

### הרשאות משולשות
ישנם משתמשים שיכולים להריץ קבצים, כמו למשל סקריפטים של מעטפת. ישנם משתמשים שיכולים לכתוב אל קבצי המחשב. ויש משתמש שיכול רק לקרוא, ויש אחד שאינו יכול לגשת כלל לקבצים או תקיות.

באופן כללי מחלקים לשלושה קטגוריות את גובה ההרשאות: יוצר הקובץ, חברי הקבוצה, אחרים. ולכל אחד מהקטגוריות יש שלושה מצבים: קריאה, כתיבה, הרצה.
## ניהול ההרשאות
כדי לצפות בהרשאות קובץ או תיקייה, נוכל לעשות זאת עם פקודת הרשימה `ls` עם הוספת הפורמט המורחב `l-`:

```bash
ls -l
```

```bash
drwxr-xr-x 23 oracle staff 4096 Jun 17 10:05 Desktop 
drwxr-xr-x 17 oracle staff 4096 Jun 17 10:04 Documents 
drwxr-xr-x 10 oracle staff 4096 Jun 17 10:03 Downloads 
-rw-r--r-- 1 oracle staff 1317 Jun 17 10:05 example.txt 
drwxr-xr-x 15 oracle staff 4096 Jun 17 10:03 Music 
drwxr-xr-x 10 oracle staff 4096 Jun 17 10:03 Pictures 
drwxr-xr-x 6 oracle staff 4096 Jun 17 10:04 Public 
drwxr-xr-x 17 oracle staff 4096 Jun 17 10:03 Templates 
drwxr-xr-x 10 oracle staff 4096 Jun 17 10:03 Videos
```

נפרק את הרשימה לגורמים: 

1. הרשאות, להלן נרחיב את הביאור.
2. קישורים לקובץ,
3. בעלים,
4. קבוצה,
5. גודל (בבתים),
6. תאריך וזמן שינוי אחרון,
7. שם התיקייה או הקובץ.

נסדר את זה גם בצורה הטבלאית:

| drwxr-xr-x | 23      | oracle | staff | 4096         | Jun 17 10:05           | Desktop         |
| ---------- | ------- | ------ | ----- | ------------ | ---------------------- | --------------- |
| הרשאות     | קישורים | משתמש  | קבוצה | גודל - בבתים | תאריך וזמן שינוי אחרון | שם התיקייה/קובץ |

### מבנה שדה ההרשאות
שדה ההרשאות כולל 10 תווים המייצגים את ההרשאות של כל קבוצה. זה מתחלק כך:

1. התו הראשון מייצג את הפריט, אם הוא קובץ - הוא מיוצג ב-`-`, אם הוא תיקייה מיוצג ב-`d`, אם זה לינק הוא מיוצג כ-`l`.
2. שלושה התווים הבאים מייצגים את ההרשאות של הבעלים,
3. שלושה התווים לאחריהם - את הרשאות הקבוצה,
4. שלושה תווים אחרונים את הרשאות של האחרים.

תוכלו לראות את המבנה בטבלה הבאה:

| d      | rwx   | r-x   | r-x   |
| ------ | ----- | ----- | ----- |
| תיקייה | בעלים | קבוצה | אחרים |

### גובה ההרשאה
לאחר שהבנו את פשר השדה של 10 התווים, נסביר מהם השלושה תווים שמיוצגים בהרשאות: `rwx`:

1. קריאה מסומן כ-`r`, קיצור של `read`
2. כתיבה מסומן ב-`w` קיצור של `write`
3. הרצה מוסמן ב-`x` קיצור של `Execute`

בטבלה תראו את הסדר:

| r     | w     | x    |
| ----- | ----- | ---- |
| קריאה | כתיבה | הרצה |

## כיצד משנים הרשאות
ניתן לשנות את ההרשאות באמצעות הפקודוה `chmod` ניתן באמצעותה להגביה הרשאות עבור משתמש או קבוצה, וניתן גם להנמיך הרשאות עבור משתמש או קבוצה.

### שני דרכים לייצוג הרשאה
ישנם שני דרכים כיצד לייצג את ההרשאות בפקודות, אחת באופן מספרי, ובאופן של אותיות. ונסביר: ניתן לייצג את ההרשאות באופן של ספירת ביטים. דהיינו ישנם שלושה הרשאות, קריאה כתיבה והרצה. כל הרשאה מייצגת ביט, וכל ביט יכול הליות בשני מצבים - דלוק/כבוי. ואם נחשב את שלושת הביטים הרי הביט הימני הוא 1, השני  הוא 2 ($2^1$) והביט השלישי מייצג 4 ($2^2$). נרהא בטבלה קטנה את הסדר (הסימן `|` מייצג ביט):

| \|  | \|  | \|  |
| --- | --- | --- |
| 4   | 2   | 1   |
ניקח את זה לעניינו - הרשאות, נציב את ההאותיות של ההרשאות במקום הביטים, וכעת כל מספר מייצג אות. המספר 1 מייצג `x`, המספר 2 את `w`, והמספר 4 מייצג `r`.

| r   | w   | x   |
| --- | --- | --- |
| 4   | 2   | 1   |
#### שיטת המספרים
כעת נוכל לפרט את ההרשאות השונות לדוגמא:

- המספר 1 = הרצת תוכנית בלבד,
- המספר 2 = כתיבה לקובץ בלבד,
- המספר 4 = קריאת קובץ בלבד.

אם נרצה לתת שני הרשאות או שלוש - נחבר את המספרים:

- המספר 7 = הרצה, כתיבה וקריאה ($4+2+1$).
- המספר 6 = קריאה וכתיבה בלבד ($4+2$),
- המספר 5 = קריאה והרצה בלבד ($4+1$),
- המספר 3 = הרצה וכתיבה בלבד ($2+1$).

ושכותבים את הפקודות - מציינים שלוש מספרים, מספר השמאלי לבעל הקובץ/תיקייה, מספר אמצעי לקבוצה ומספר ימני לאחרים.
#### דוגמה לפקודות עם מספרים
להלן הרשאות (ברירת המחדל) של התיקייה `Desktop`:

```sh
drwxr-xr-x 23 oracle staff 4096 Jun 17 10:05 Desktop 
```

אנו רואים את רמת ההרשאות שהיא:

- קריאה כתיבה והרצה `rwx` לבעל התיקייה,
- קריאה והרצה `r-x` לקבוצה,
- קריאה והרצה `r-x` לאחרים.

ניח שיש לנו חומר חסוי שאיננו רוצים שאף אחד חוץ מבעל התקייה וחברי קבוצת המשתמשים הרשומים בתיקייה זו יוכלו לצפות כלל ולא יוכלו לפתוח את התיקייה, אוכל לעשות זאת עם הפקודה הבאה:

```sh
chmod 770 Desktop
```

כזכור, המספר 7 מייצג חיבור של קריאה כתיבה והרצה ($4+2+1$) כך שמספר ימני קובע לבעל התיקייה את ההרשאות המלאות, המספר השני את ההרשאות המלאות לחברי הקבוצה, והמספר השלישי אפס הרשאות לאחרים.

כעת לא יוכלו משתמשים אחרים להיכנס לתיקייה, ולצפות ולשנות דברים בה.

### שיטת האותיות
נוכל לכתוב את הפקודה על ידי שימוש באותיות קיצור של ההרשאות. למשל, הפקודה הבאה תוסיף הרשאות כתיבה לקבוצה:

```sh
chmod g+w Desktop
```

**נסביר את הפקודה:**

- אנו מעוניינים לשנות הרשאות עבור הקבוצה `g`,
- אנו רוצים להוסיף הרשאות `+`,
- ההרשאות שאנו מעוניינים להוסיף הם כתיבה `w`.

באותו אופן נוכל גם להוסיף הרשאות הרצה לקובץ לככולם על ידי כתיבה רק את רמת ההרשאה. למשל, אם כתבנו סקריפט, אנו צריכים לתת לו הרשאה לרוץ ולבצע את משימתו. ולכן אנו מוסיפים את ההרשאה של הרצה באמצעות ציון `x+`:

```sh
chmod +x script.sh
```

כעת כל משתמש יוכל להריץ את הסקריפט.

# סיכום
למדנו על קצה המזלג את יסודות ההרשאות של קבצים ותיקיות. למדנו להשתמש עם הפקודה `chmod` בשני צורות: ייצוג מספרי וייצוג אותיות.